CREATE EXTENSION IF NOT EXISTS "pgcrypto";
CREATE TABLE IF NOT EXISTS CITIES (
    CITY_UUID UUID DEFAULT gen_random_uuid() PRIMARY KEY NOT NULL,
    CITY_ID NUMERIC UNIQUE NOT NULL,
    CITY VARCHAR UNIQUE NOT NULL
);

CREATE TABLE IF NOT EXISTS ZIP_CODES (
    ZIP_CODE_UUID UUID DEFAULT gen_random_uuid() PRIMARY KEY NOT NULL,
    ZIP_CODE_ID NUMERIC UNIQUE NOT NULL,
    ZIP_CODE VARCHAR UNIQUE NOT NULL
);

CREATE TABLE IF NOT EXISTS DESCRIPTIONS (
    DESCRIPTION_UUID UUID DEFAULT gen_random_uuid() PRIMARY KEY NOT NULL,
    DESCRIPTION_ID NUMERIC UNIQUE NOT NULL,
    DESCRIPTION_TEXT VARCHAR UNIQUE NOT NULL
);

CREATE TABLE IF NOT EXISTS LAST_NAMES (
    LAST_NAME_UUID UUID DEFAULT gen_random_uuid() PRIMARY KEY NOT NULL,
    LAST_NAME_ID NUMERIC UNIQUE NOT NULL,
    LAST_NAME VARCHAR UNIQUE NOT NULL
);

CREATE TABLE IF NOT EXISTS FIRST_NAMES (
    FIRST_NAME_UUID UUID DEFAULT gen_random_uuid() PRIMARY KEY NOT NULL,
    FIRST_NAME_ID NUMERIC UNIQUE NOT NULL,
    FIRST_NAME VARCHAR UNIQUE NOT NULL
);

CREATE TABLE IF NOT EXISTS PROVIDER_RECORDS (
    PROVIDER_UUID UUID DEFAULT gen_random_uuid() PRIMARY KEY NOT NULL,
    DESCRIPTION_ID NUMERIC NOT NULL,
    CITY_ID NUMERIC NOT NULL,
    FIRST_NAME_ID NUMERIC NOT NULL,
    LAST_NAME_ID NUMERIC NOT NULL,
    ZIP_CODE_ID NUMERIC NOT NULL,
    CREATED_AT TIMESTAMP DEFAULT CURRENT_TIMESTAMP NOT NULL,
    UNIQUE(CITY_ID, FIRST_NAME_ID, LAST_NAME_ID, ZIP_CODE_ID, DESCRIPTION_ID),
    FOREIGN KEY (CITY_ID) REFERENCES CITIES(CITY_ID),
    FOREIGN KEY (ZIP_CODE_ID) REFERENCES ZIP_CODES(ZIP_CODE_ID),
    FOREIGN KEY (DESCRIPTION_ID) REFERENCES DESCRIPTIONS(DESCRIPTION_ID),
    FOREIGN KEY (LAST_NAME_ID) REFERENCES LAST_NAMES(LAST_NAME_ID),
    FOREIGN KEY (FIRST_NAME_ID) REFERENCES FIRST_NAMES(FIRST_NAME_ID)    
);